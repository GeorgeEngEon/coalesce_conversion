steps:
  STG_ORDERS_BY_MONTH_CTE_FINAL_1-37f365e8471103b41454fe4deb51208543f0799f5971289cffcd8f29d829162c:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: true
      locationName: BI
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 94611c2424a95a10b3fe50dff4f828f40445ae5ad6639675da408c8d3057ef58
              stepCounter: 37f365e8471103b41454fe4deb51208543f0799f5971289cffcd8f29d829162c
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: AMOUNT_MONTH_GTEQ_2
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e2d96470dd9cad6ea95a6f83ba2a96decdc1f3303d3d17b80c99519d001aa03b
                    stepCounter: e1e23fd6c913f102675f937d7ad19b8e8801577159c6b8b72a16b37fa0a72052
                transform: sum(case when month(user_amount.first_order_date) >= 2 then user_amount.total_amount else 0 end)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 10935db703770600b238a7b779bee07839c97c7f0452852e206385f10a7611d6
              stepCounter: 37f365e8471103b41454fe4deb51208543f0799f5971289cffcd8f29d829162c
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: AMOUNT_MONTH_LT_1
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e2d96470dd9cad6ea95a6f83ba2a96decdc1f3303d3d17b80c99519d001aa03b
                    stepCounter: e1e23fd6c913f102675f937d7ad19b8e8801577159c6b8b72a16b37fa0a72052
                transform: sum(case when month(user_amount.first_order_date) < 2 then user_amount.total_amount else 0 end)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 185599cad5a545323c1892bff60a7b9d580095f69c5113fe2f03360d241e770b
              stepCounter: 37f365e8471103b41454fe4deb51208543f0799f5971289cffcd8f29d829162c
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: CUSTOMER_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 692478cedeea456ec17d1cf8fc23a2b3d8490cdfbb0df4718fb55d3537a5dff1
                    stepCounter: e1e23fd6c913f102675f937d7ad19b8e8801577159c6b8b72a16b37fa0a72052
                transform: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: BI
                nodeName: STG_ORDERS_BY_MONTH_CTE_USER_AMOUNT_1
            join:
                joinCondition: FROM {{ ref('BI', 'STG_ORDERS_BY_MONTH_CTE_USER_AMOUNT_1') }} "STG_ORDERS_BY_MONTH_CTE_USER_AMOUNT_1"
            name: STG_ORDERS_BY_MONTH_CTE_FINAL_1
            noLinkRefs: []
      name: STG_ORDERS_BY_MONTH_CTE_FINAL_1
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 37f365e8471103b41454fe4deb51208543f0799f5971289cffcd8f29d829162c