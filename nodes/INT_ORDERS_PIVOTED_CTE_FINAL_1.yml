steps:
  INT_ORDERS_PIVOTED_CTE_FINAL_1-3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: true
      locationName: DBT_GGITHIRI
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: cd6eedb5ad321026b9dd8baff68bb34d40d8c2f78a15e4961e7cbc5ee8d8d770
              stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: BANK_TRANSFER_A
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581906560c2b790bfd4ada1c6ed181c1a0663f7e8a58ab3e27409019891bf35d
                    stepCounter: ee5aafaaba6856967aa7131442e1ef1c41bb294c987c063c87e5c66d28d9d86d
                transform: sum( case when payment_method = 'bank_transfer' then amount else 0 end )
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 00d6951a6bcbaca73a7e15715a4601f23fafc9cce6d88c34860d00d3ae8fc47c
              stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: COUPON_A
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581906560c2b790bfd4ada1c6ed181c1a0663f7e8a58ab3e27409019891bf35d
                    stepCounter: ee5aafaaba6856967aa7131442e1ef1c41bb294c987c063c87e5c66d28d9d86d
                transform: sum( case when payment_method = 'coupon' then amount else 0 end )
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 6fbae01b20b25bc6cbc53ae9a4d9d1c2b143fc13bc1f4b11ba396912b5fdfb07
              stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: CREDIT_CARD_A
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581906560c2b790bfd4ada1c6ed181c1a0663f7e8a58ab3e27409019891bf35d
                    stepCounter: ee5aafaaba6856967aa7131442e1ef1c41bb294c987c063c87e5c66d28d9d86d
                transform: sum( case when payment_method = 'credit_card' then amount else 0 end )
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: e8b687d50d4620f85125c9ecbaf9fe547ce1ffc28a559fc5242f26c8457849e8
              stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: GIFT_CARD_A
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581906560c2b790bfd4ada1c6ed181c1a0663f7e8a58ab3e27409019891bf35d
                    stepCounter: ee5aafaaba6856967aa7131442e1ef1c41bb294c987c063c87e5c66d28d9d86d
                transform: sum( case when payment_method = 'gift_card' then amount else 0 end )
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 82f058a9ba75df6a1464aaa755b739f97a435cfb69e8399137583ad9ce26f805
              stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d
            dataType: ""
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 581906560c2b790bfd4ada1c6ed181c1a0663f7e8a58ab3e27409019891bf35d
                    stepCounter: ee5aafaaba6856967aa7131442e1ef1c41bb294c987c063c87e5c66d28d9d86d
                transform: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: DBT_GGITHIRI
                nodeName: INT_ORDERS_PIVOTED_CTE_PAYMENTS_1
            join:
                joinCondition: FROM {{ ref('DBT_GGITHIRI', 'INT_ORDERS_PIVOTED_CTE_PAYMENTS_1') }} "INT_ORDERS_PIVOTED_CTE_PAYMENTS_1"
            name: INT_ORDERS_PIVOTED_CTE_FINAL_1
            noLinkRefs: []
      name: INT_ORDERS_PIVOTED_CTE_FINAL_1
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 3bd8ebbf2d7a52ba42b9a910a058e46962e7135cd8e462c53a2cfe30e408a89d